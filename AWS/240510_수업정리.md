ðŸ“Œì•„ëž˜ì˜Â í´ë”Â ë§Œë“¤ì–´Â ì£¼ì„¸ìš”  
  
mkdirÂ -pÂ /home/ubuntu/download/upload  
mkdirÂ /home/ubuntu/oracle  
lsÂ -alÂ /home/ubuntu/download/upload  
lsÂ -alÂ /home/ubuntu/oracle  
  
  
1.Â jarÂ ë‹¤ì‹œÂ ë§Œë“¤ê¸°  
Â Â Â cleanÂ compileÂ package  
Â Â Â pom.xmlÂ ì—†ì• ê¸°  
Â Â Â SkipÂ testsÂ ì²´í¬ë°•ìŠ¤Â ì œê±°  
  
  
2.Â DockerfileÂ ë§Œë“¤ê¸°Â &&Â ì´ë¯¸ì§€Â ë§Œë“¤ê¸°
(ë„ì»¤ì•„ì´ë””/security_aws:01)  
Â Â Â (1)Â í”„ë¡œì íŠ¸Â í´ë”ì—Â ì´ë¯¸ì§€ê°€Â ìžˆëŠ”ì§€Â í™•ì¸  
Â Â Â (2)Â DockerfileÂ   
Â Â Â Â Â Â Â Â FROMÂ openjdk:17-ea-11-jdk-slim  
  Â Â Â Â Â Â COPYÂ ./target/myhome4-0.0.1-SNAPSHOT.jarÂ /security.jarÂ   
Â Â Â Â Â Â Â Â COPYÂ ./icecream.pngÂ Â ./icecream.png
Â Â Â Â Â Â Â Â RUNÂ mkdirÂ ./imageÂ &&Â mvÂ ./icecream.pngÂ ./image/icecream.png  
Â Â Â Â Â Â Â Â ENTRYPOINTÂ \["java",Â "-jar",Â "security.jar"]
Â Â Â Â (3)Â dockerÂ imageÂ buildÂ -tÂ ë„ì»¤ì•„ì´ë””/security_aws:01Â Â Â Â -fÂ Dockerfile_awsÂ .  
  
3.Â ë§Œë“ Â ì´ë¯¸ì§€Â ë„ì»¤Â í—ˆë¸Œì—Â ì˜¬ë¦¬ê¸°  
Â Â Â dockerÂ imageÂ pushÂ ë„ì»¤ì•„ì´ë””/security_aws:01  
  
4.Â docker-compose.yamlÂ íŒŒì¼Â ì™„ì„±  
Â Â Â sudoÂ docker-composeÂ upÂ -d  
Â Â Â sudoÂ docker-composeÂ downÂ --rmiÂ all

![](../image/Pasted%20image%2020240510103137.png)


![](../image/Pasted%20image%2020240510101350.png)

ðŸ“Œimage í´ë”ëŠ” ì–´ë””ì— ìžˆëŠ” ê±¸ê¹Œ? icecream.png ëŠ”??


# Jenkins
![](../image/Pasted%20image%2020240510120256.png)

ðŸ“ŒJenkins ì„œë²„ ë”°ë¡œ / ë°°í¬ ì„œë²„ ë”°ë¡œ ë§Œë“ ë‹¤.

ðŸ“ŒSTSì—ì„œ ë³€ê²½í•œ ë‚´ìš©ì„ githubì— ì˜¬ë¦°ë‹¤.

ðŸ“Œhook ì´ë²¤íŠ¸ë¥¼ webì— ë“±ë¡í•˜ì—¬ Jenkinsê°€ ì¸ì‹í•  ìˆ˜ ìžˆë„ë¡ í•œë‹¤.

## github repository ìƒì„±
## toekn ìž¬ë°œê¸‰

## STSì—ì„œ web2024 repo clone
## ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ ìƒì„±
![](../image/Pasted%20image%2020240510122549.png)

ðŸ“Œsrc í´ë” / pom.xml / icecream.png / Dockerfile ë³µì‚¬í•œ í›„ github repositoryì— share / commit / push í•œë‹¤.


## ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ í•˜ë‚˜ ë§Œë“ ë‹¤
ðŸ“Œì¸ìŠ¤í„´ìŠ¤ ìœ í˜• t2 micro -> í”„ë¦¬í‹°ì–´ë¡œ ì‚¬ìš© 
ðŸ“Œí‚¤ íŽ˜ì–´ - CICD
ðŸ“ŒìŠ¤í† ë¦¬ì§€ êµ¬ì„± 30GiB
ðŸ“ŒjenkinsëŠ” 8080 í¬íŠ¸ë¥¼ ì‚¬ìš© í•œë‹¤. -> ë³´ì•ˆ ê·¸ë£¹ ì¶”ê°€í•´ì•¼ í•œë‹¤

![](../image/Pasted%20image%2020240510141049.png)

![](../image/Pasted%20image%2020240510141113.png)

ðŸ“Œí¬íŠ¸ ë²”ìœ„ë¥¼ 8080, ì†ŒìŠ¤ì— Anywhere IPv4ë¡œ ì„¤ì •í•œë‹¤.


## putty ì ‘ì†
ðŸ“Œputtyë¡œÂ ì ‘ì†Â í•©ë‹ˆë‹¤.  
Â Â Â Â (1)Â CategoryÂ :Â SessionÂ Â   
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â HostÂ NameÂ :Â EC2Â í¼ë¸”ë¦­Â ì£¼ì†ŒÂ ìž…ë ¥  
Â Â Â Â (2)Â CategoryÂ :Â ConnectionÂ ->Â SSHÂ ->Â AuthÂ ->Â CredentialsÂ ->Â Â ì•žì—ì„œÂ EC2Â ë§Œë“¤ë©´ì„œÂ ìƒì„±í•œÂ í‚¤íŽ˜ì–´Â ppkë¥¼Â ì„ íƒí•©ë‹ˆë‹¤.Â Â Â Â Â Â Â Â   
Â Â Â Â (3)Â CategoryÂ :Â SessionÂ   
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â SavedÂ SessionsÂ :Â jenkinsÂ Â ->Â Save  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â OpenÂ í´ë¦­  
Â Â Â Â (4)Â AcceptÂ í´ë¦­


## imageë¥¼ í™œìš©í•˜ì—¬ jenkins ì“°ê¸°
ðŸ“Œë„ì»¤ ì„¤ì¹˜(https://jongsky.tistory.com/49) ë„ì»¤ ì»´í¬ì¦ˆëŠ” ì„¤ì¹˜í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.

ðŸ“Œ(https://www.jenkins.io/doc/)
Â JenkinsëŠ”Â ì†Œí”„íŠ¸ì›¨ì–´Â êµ¬ì¶•,Â í…ŒìŠ¤íŠ¸,Â ì œê³µÂ ë˜ëŠ”Â ë°°í¬ì™€Â ê´€ë ¨ëœÂ ëª¨ë“ Â ì¢…ë¥˜ì˜Â ìž‘ì—…ì„Â ìžë™í™”í•˜ëŠ”Â ë°Â ì‚¬ìš©í• Â ìˆ˜Â ìžˆëŠ”Â ë…ë¦½í˜•Â ì˜¤í”ˆÂ ì†ŒìŠ¤Â ìžë™í™”Â ì„œë²„ìž…ë‹ˆë‹¤. ìžë°”ë¡œÂ ì œìž‘ëœÂ CI(ContinuousÂ Integration)Â Â íˆ´ìž…ë‹ˆë‹¤.
- íŒŒì´í”„ë¼ì¸ ì´ìš©í•´ì„œ CD ê¹Œì§€ ê°™ì´ í•´ë³¸ë‹¤!


![](../image/Pasted%20image%2020240510143550.png)

ðŸ“Œsudo docker run -d -p 8080:8080 --name jenkins -v /home/jenkins:/var/jenkins_home -v /var/run/docker.sock:/var/run/docker.sock -u root jenkins/jenkins:lts




ðŸ“Œì²«ë²ˆì§¸ ì„¤ì¹˜í•œ ë„ì»¤ëŠ” AWS ê°€ìƒ ì„œë²„ì— ìžˆë‹¤.
`JENKINS ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ë„ dockerê°€ ì„¤ì¹˜ë˜ì–´ ìžˆì–´ì•¼ í•œë‹¤.`
- sudoÂ dockerÂ execÂ jenkinsÂ aptÂ update
- sudoÂ dockerÂ execÂ jenkinsÂ aptÂ installÂ -yÂ docker.io

![](../image/Pasted%20image%2020240510144425.png)

ðŸ“Œpublic ip:8080 ìž…ë ¥í•˜ë©´ í•´ë‹¹ íŽ˜ì´ì§€ë¡œ ì´ë™í•œë‹¤.

![](../image/Pasted%20image%2020240510144809.png)

ðŸ“Œjenkins ì»¨í…Œì´ë„ˆë¡œ ë“¤ì–´ê°€ì„œ ìž‘ì—…í•œë‹¤.

ðŸ“Œsudo docker exec -it jenkins /bin/bash

![](../image/Pasted%20image%2020240510144958.png)

![](../image/Pasted%20image%2020240510145018.png)

ðŸ“Œë¹„ë°€ë²ˆí˜¸ë¥¼ ìž…ë ¥í•˜ë©´ í•´ë‹¹ íŽ˜ì´ì§€ë¡œ ì´ë™í•œë‹¤.

ðŸ“Œëª¨ë“  ì¹¸ì´ ì´ˆë¡ìƒ‰ìœ¼ë¡œ ì²´í¬ ë˜ì–´ì•¼ ì„±ê³µì´ë‹¤. ë¹¨ê°„ìƒ‰ìœ¼ë¡œ í‘œì‹œë˜ë©´ aws ì¸ìŠ¤í„´ìŠ¤ ì œê±° í›„ ë‹¤ì‹œ ì²˜ìŒë¶€í„° ìž‘ì—…í•œë‹¤.

![](../image/Pasted%20image%2020240510155024.png)

![](../image/Pasted%20image%2020240510160213.png)

![](../image/Pasted%20image%2020240510160244.png)

![](../image/Pasted%20image%2020240510160253.png)

![](../image/Pasted%20image%2020240510162832.png)

## github repositoryë¡œ ì´ë™
![](../image/Pasted%20image%2020240510163056.png)

ðŸ“ŒSettings > Webhooks > Add webhooks

![](../image/Pasted%20image%2020240510163235.png)

ðŸ“ŒPayload URL / Content Type ë³€ê²½í•œë‹¤.
- http://15.164.233.151:8080/github-webhook/

![](../image/Pasted%20image%2020240510163523.png)

ðŸ“Œì´ˆë¡ìƒ‰ìœ¼ë¡œ ì²´í¬ê°€ ëœë‹¤.


## jenkinsì—ì„œ maven pluginì„¤ì¹˜í•˜ê¸°
ðŸ“Œstsì—ì„œ jarë¡œ ë°°í¬ê°€ ì‰½ê²Œ ë˜ì—ˆë˜ ì´ìœ ëŠ” stsì—ì„œ í•´ë‹¹ í”ŒëŸ¬ê·¸ì¸ì´ ì„¤ì¹˜ë˜ì–´ ìžˆì–´ì„œ ë²„íŠ¼ ëª‡ ë²ˆìœ¼ë¡œ ì‰½ê²Œ ì§„í–‰ë˜ì—ˆë˜ ê²ƒì´ë‹¤.

ðŸ“ŒDashboard  
=>Â Â JenkinsÂ ê´€ë¦¬Â   
=>Â Â SystemÂ ConfigurationÂ ->Â ToolsÂ   
=>Â Â MavenÂ installations  
=>Â Â AddÂ MavenÂ ì„ íƒ  
Â Â Â Â Â Â NameÂ :Â maven (ìŠ¤í¬ë¦½íŠ¸ì—ì„œÂ ì‚¬ìš©í• Â ì´ë¦„)
Â Â Â Â Â Â ì²´í¬ë°•ìŠ¤Â ì„ íƒÂ InstallÂ automatically  
Â Â Â Â Â Â InstallÂ fromÂ Apache  
Â Â Â Â Â Â versionÂ Â :Â 3.8.4  
=>Â Apply 
=>Â Save

ðŸ“Œìƒˆë¡œìš´ Item -> ìƒˆë¡œìš´ project ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤.



## ë„ì»¤ CI íŒŒì´í”„ë¼ì¸ìš© í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜
ðŸ“ŒDashboard  
=>Â JenkinsÂ ê´€ë¦¬Â   
=>Â SystemÂ ConfigurationÂ ->Â PluginsÂ   
=>Â ì™¼ìª½Â Â AvailableÂ pluginsÂ ì„ íƒ  
Â Â ->Â SSHÂ PipelineÂ StepsÂ ê²€ìƒ‰Â   
Â Â ->Â InstallÂ   
=>Â ë©”ì¸Â íŽ˜ì´ì§€ë¡œÂ ëŒì•„ê°€ê¸°  
=>Â ì„¤ì¹˜Â ì„±ê³µì´Â ë˜ë©´Â ë©”ì¸Â íŽ˜ì´ì§€ë¡œÂ ëŒì•„ê°€ê¸°Â ì„ íƒ


## ë„ì»¤ í—ˆë¸Œì— ì˜¬ë¦¬ê¸° ìœ„í•´ ë„ì»¤ í—ˆë¸Œì˜ Credentials ë“±ë¡í•˜ê¸°
ðŸ“ŒDashboardÂ   
=>Â Jenkinsê´€ë¦¬Â   
=>Â Â SecurityÂ ->Â Credentials 
=>Â StoresÂ scopedÂ toÂ Jenkinsì˜Â Â Â SystemÂ í´ë¦­Â 
=>Â GlobalÂ credentialsÂ (unrestricted)Â Â Â Â Â Â Â Â Â Â   
=>Â AddÂ Credentials
	Â UsernameÂ :Â ë„ì»¤í—ˆë¸Œì•„ì´ë””  
Â Â Â Â Â Â Â Â Â Password:Â ë„ì»¤í—ˆë¸Œë¹„ë°€ë²ˆí˜¸  
Â Â Â Â Â Â Â Â Â IDÂ :Â dockerhub  
Â Â Â Â Â Â Â Â Â DescriptionÂ :Â dockerhub  
=>Â Create

![](../image/Pasted%20image%2020240510164924.png)


## Pipeline Project ë§Œë“¤ê¸°
![](../image/Pasted%20image%2020240510170230.png)

![](../image/Pasted%20image%2020240510170545.png)

### ì„¤ëª…
ðŸ“ŒJenkinsÂ PipelineÂ ì§€ì†ì Â í†µí•©Â ë°Â ì§€ì†ì Â ì „ë‹¬ì„Â ìžë™í™”í•˜ê¸°Â ìœ„í•œÂ ë„êµ¬ìž…ë‹ˆë‹¤.  
1.JenkinsÂ Pipelineì„Â ì •ì˜í•˜ëŠ”Â ë¸”ë¡ìž…ë‹ˆë‹¤.Â ì´Â ë¸”ë¡Â ë‚´ì—ëŠ”Â íŒŒì´í”„ë¼ì¸ì˜Â êµ¬ì„±Â ìš”ì†Œê°€Â ì •ì˜ë©ë‹ˆë‹¤.  
2.agentëŠ”Â ì´Â íŒŒì´í”„ë¼ì¸Â ìŠ¤í¬ë¦½íŠ¸ë¥¼Â ì‹¤í–‰í• Â executorë¥¼Â ì§€ì •í•©ë‹ˆë‹¤.Â anyë¡œÂ ë‘ë©´Â ì–´ë–¤Â executorë„Â ì‹¤í–‰í• Â ìˆ˜Â ìžˆë‹¤ëŠ”Â ì˜ë¯¸ê°€Â ë©ë‹ˆë‹¤.  
3.stagesëŠ”Â ì‹¤í–‰í• Â Jobë“¤ì˜Â ì§‘í•©ìž…ë‹ˆë‹¤  
4.stageëŠ”Â ê°ê°ì˜Â Jobì„Â ì˜ë¯¸í•©ë‹ˆë‹¤.Â JobÂ ë‚´ë¶€ì˜Â ë‹¨ê³„ë¥¼Â ì˜ë¯¸í•˜ëŠ”Â stepsë¥¼Â í¬í•¨í•´ì•¼í•©ë‹ˆë‹¤.  
5.stepsì—ì„ Â ì‹¤ì œë¡œÂ ì‹¤í–‰í• Â ì‰˜ì´ë‚˜Â syntaxë¥¼Â ìž…ë ¥í•´ì£¼ë©´Â ë©ë‹ˆë‹¤.



## ì§€ê¸ˆ ë¹Œë“œ ëˆ„ë¥´ê¸°
![](../image/Pasted%20image%2020240510170958.png)

![](../image/Pasted%20image%2020240510171030.png)


## GitHub ê´€ë ¨ ì •ë³´ ìž…ë ¥
![](../image/Pasted%20image%2020240510171345.png)

![](../image/Pasted%20image%2020240510171551.png)

ðŸ“ŒSample Step -> git: Git

![](../image/Pasted%20image%2020240510171905.png)

ðŸ“Œgithub ê´€ë ¨ ì •ë³´ë¥¼ ìž…ë ¥í•œë‹¤.

![](../image/Pasted%20image%2020240510172134.png)

ðŸ“Œgithub ê´€ë ¨ ì •ë³´ë¥¼ ìž…ë ¥í•œ í›„ credential ì„¤ì •ì„ í•˜ë©´,, ë¹¨ê°„ìƒ‰ ì—ëŸ¬ê°€ ì‚¬ë¼ì§„ë‹¤. Generate Pipeline Script í•˜ë©´, ì–´ë–¤ ì •ë³´ê°€ ëœ¬ë‹¤.

git branch: 'main', credentialsId: 'github', url: 'https://github.com/gamjoo/web2024'

![](../image/Pasted%20image%2020240510172625.png)

```
pipeline {
    agent any

    tools {
        // ì„¤ì¹˜ëœ Mavenì˜ ì´ë¦„
        maven "maven"
    }

    stages {
        stage('Git Pull') {
            steps {
                 //  GitHub ì €ìž¥ì†Œì—ì„œ ì½”ë“œë¥¼ ê°€ì ¸ì˜¤ëŠ” ìž‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
                git branch: 'main', credentialsId: 'github', url: 'https://github.com/gamjoo/web2024'
            }
        }
         
        stage('Build') {
            steps {    
                      //clone ë°›ì€ í”„ë¡œì íŠ¸ ì•ˆì˜ Spring10_Security_Thymeleaf_Jenkins ë””ë ‰í† ë¦¬ì—ì„œ stage ì‹¤í–‰  
                      dir("Spring10_Security_Thymeleaf_Jenkins"){     
                           sh "mvn -DskipTests  clean package"  
                    }  
            }
       
     }
    }
}
```

ðŸ“ŒApply -> ì €ìž¥ í›„ 